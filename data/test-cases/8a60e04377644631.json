{"uid":"8a60e04377644631","name":"Calculation Testing | Scenario=S17 | Mode=RuPay Card | Slab=1-1000 | Amount=100","fullName":"testCases.Calculation_test.TestCalculations#test_calculation_amount","historyId":"df2beacaacade1ff3bc66dfe5a0f5eac","time":{"start":1758800447633,"stop":1758800496036,"duration":48403},"status":"broken","statusMessage":"ValueError: Excel file format cannot be determined, you must specify an engine manually.","statusTrace":"self = <testCases.Calculation_test.TestCalculations object at 0x000001CB507191D0>\npage_with_screenshot = <Page url='https://stage-securepay.sabpaisa.in/SabPaisa/sabPaisaInit?v=1'>\nscenario = 'S17', payment_mode = 'RuPay Card', slab = '1-1000', amount = 100\nexcel_client_code = 'DJ050', excel_environment = 'STAGING'\nensure_db_updated = None\n\n    @allure.story(\"Cancel Transaction Button Check\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.ui\n    @pytest.mark.regression\n    def test_calculation_amount(self, page_with_screenshot, scenario, payment_mode, slab, amount, excel_client_code,\n                                excel_environment, ensure_db_updated):\n        logger = LogGen.loggen(\"Calculation\")\n        \"\"\"Test the cancel transaction button functionality.\"\"\"\n        timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n        allure.dynamic.title(\n            f\"Calculation Testing | Scenario={scenario} | Mode={payment_mode} | Slab={slab} | Amount={amount}\"\n        )\n        logger.info(f\"--- Starting calculation Test for {scenario} | {payment_mode} | {slab} | {amount} ---\")\n    \n        bill_amount = conv_charges = total_amount = txn_id = \"N/A\"\n        status = \"Fail\"\n    \n        try:\n            if payment_mode == \"UPI INTENT\":\n                viewport_size = {\"width\": 375, \"height\": 667}  # Example: iPhone-like dimensions\n                page_with_screenshot.set_viewport_size(viewport_size)\n                logger.info(\n                    f\"Set viewport size to {viewport_size['width']}x{viewport_size['height']} for UPI INTENT mode\")\n                allure.attach(page_with_screenshot.screenshot(), name=\"UPI Intent Initial Viewport\",\n                              attachment_type=allure.attachment_type.PNG)\n    \n    \n            # Initialize page objects\n            client = ClientPage(page_with_screenshot)\n            client_details = ClientDetailsPage(page_with_screenshot)\n            pg = PaymentGatewayPage(page_with_screenshot)\n            pg_response = PaymentGatewayResponsePage(page_with_screenshot)\n    \n            # Fill and verify client and payer details\n            fill_and_verify_client_details(self.logger, client, client_details, excel_client_code, excel_environment)\n            fill_payer_details(\n                logger, client_details, ReadConfig.get_payer_first_name(),\n                ReadConfig.get_payer_last_name(), str(amount), ReadConfig.get_payer_phone(),\n                ReadConfig.get_payer_email()\n            )\n    \n            # Get transaction ID\n            with allure.step(f\"Accessing the Client_txn_id\"):\n                txn_id = client_details.get_value(\"_client_transaction_id\")\n                allure.attach(txn_id, name=f\"Client Transaction ID for {excel_client_code}\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            # Click Pay button\n            with allure.step(\"Clicking Pay Button\"):\n                logger.info(\"Clicking Pay button\")\n                client_details.click(\"_pay_btn\")\n    \n            time.sleep(5)\n    \n            # Handle payment mode and get amounts\n>           bill_amount, conv_charges, total_amount = self._handle_payment_mode(pg, payment_mode, logger)\n\ntestCases\\Calculation_test.py:216: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntestCases\\Calculation_test.py:59: in _handle_payment_mode\n    pg.select_payment_mode(\"_payment_mode\", pm_data[\"type\"])\npageObjects\\base_page.py:52: in select_payment_mode\n    modes.first.wait_for(state=\"visible\")\n.venv\\Lib\\site-packages\\playwright\\sync_api\\_generated.py:17736: in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n.venv\\Lib\\site-packages\\playwright\\_impl\\_locator.py:670: in wait_for\n    await self._frame.wait_for_selector(\n.venv\\Lib\\site-packages\\playwright\\_impl\\_frame.py:323: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n.venv\\Lib\\site-packages\\playwright\\_impl\\_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <playwright._impl._connection.Connection object at 0x000001CB505A7B60>\ncb = <function Channel.send.<locals>.<lambda> at 0x000001CB50B054E0>\nis_internal = False\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(task, \"__pw_stack__\", inspect.stack())\n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.wait_for: Timeout 30000ms exceeded.\nE           Call log:\nE           waiting for locator(\"p.title\").first to be visible\n\n.venv\\Lib\\site-packages\\playwright\\_impl\\_connection.py:520: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <testCases.Calculation_test.TestCalculations object at 0x000001CB507191D0>\npage_with_screenshot = <Page url='https://stage-securepay.sabpaisa.in/SabPaisa/sabPaisaInit?v=1'>\nscenario = 'S17', payment_mode = 'RuPay Card', slab = '1-1000', amount = 100\nexcel_client_code = 'DJ050', excel_environment = 'STAGING'\nensure_db_updated = None\n\n    @allure.story(\"Cancel Transaction Button Check\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.ui\n    @pytest.mark.regression\n    def test_calculation_amount(self, page_with_screenshot, scenario, payment_mode, slab, amount, excel_client_code,\n                                excel_environment, ensure_db_updated):\n        logger = LogGen.loggen(\"Calculation\")\n        \"\"\"Test the cancel transaction button functionality.\"\"\"\n        timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n        allure.dynamic.title(\n            f\"Calculation Testing | Scenario={scenario} | Mode={payment_mode} | Slab={slab} | Amount={amount}\"\n        )\n        logger.info(f\"--- Starting calculation Test for {scenario} | {payment_mode} | {slab} | {amount} ---\")\n    \n        bill_amount = conv_charges = total_amount = txn_id = \"N/A\"\n        status = \"Fail\"\n    \n        try:\n            if payment_mode == \"UPI INTENT\":\n                viewport_size = {\"width\": 375, \"height\": 667}  # Example: iPhone-like dimensions\n                page_with_screenshot.set_viewport_size(viewport_size)\n                logger.info(\n                    f\"Set viewport size to {viewport_size['width']}x{viewport_size['height']} for UPI INTENT mode\")\n                allure.attach(page_with_screenshot.screenshot(), name=\"UPI Intent Initial Viewport\",\n                              attachment_type=allure.attachment_type.PNG)\n    \n    \n            # Initialize page objects\n            client = ClientPage(page_with_screenshot)\n            client_details = ClientDetailsPage(page_with_screenshot)\n            pg = PaymentGatewayPage(page_with_screenshot)\n            pg_response = PaymentGatewayResponsePage(page_with_screenshot)\n    \n            # Fill and verify client and payer details\n            fill_and_verify_client_details(self.logger, client, client_details, excel_client_code, excel_environment)\n            fill_payer_details(\n                logger, client_details, ReadConfig.get_payer_first_name(),\n                ReadConfig.get_payer_last_name(), str(amount), ReadConfig.get_payer_phone(),\n                ReadConfig.get_payer_email()\n            )\n    \n            # Get transaction ID\n            with allure.step(f\"Accessing the Client_txn_id\"):\n                txn_id = client_details.get_value(\"_client_transaction_id\")\n                allure.attach(txn_id, name=f\"Client Transaction ID for {excel_client_code}\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            # Click Pay button\n            with allure.step(\"Clicking Pay Button\"):\n                logger.info(\"Clicking Pay button\")\n                client_details.click(\"_pay_btn\")\n    \n            time.sleep(5)\n    \n            # Handle payment mode and get amounts\n            bill_amount, conv_charges, total_amount = self._handle_payment_mode(pg, payment_mode, logger)\n    \n    \n            #time.sleep(10)\n    \n            # Handle failure for specific scenario and slab\n            # if scenario in [\"S8\", \"S13\", \"S16\", \"S24\", \"S21\"] and slab == \"5001-10000\":\n            #     status = \"Fail\"\n            #     with allure.step(\"transaction is aborted for scenario and slab\"):\n            #         allure.attach(\n            #             f\"Scenario={scenario}, Slab={slab} is restricted → marking as Fail\",\n            #             name=\"Failure\",\n            #             attachment_type=allure.attachment_type.TEXT\n            #         )\n            #     pytest.fail(f\"Scenario={scenario}, Slab={slab} →  test as failed \")\n    \n            # \uD83D\uDD39 Call the Payment Aborted check here\n            status = self._check_payment_aborted(page_with_screenshot)\n    \n    \n    \n            # # Wait for page to load and validate URL\n            # time.sleep(5)\n            # pg_response.page.wait_for_load_state(\"networkidle\")\n            # current_url = pg_response.get_current_url()\n            # self.logger.info(f\"URL after proceed to pay: {current_url}\")\n            #\n            # with allure.step(\"Validating the Base URL\"):\n            #     assert validate_base_url(current_url,\n            #                              excel_environment), f\"Base URL validation failed for {current_url}\"\n    \n    \n    \n    \n    \n        except Exception as e:\n            self.logger.exception(\n                f\"Exception occurred during Cancel Transaction Test for {excel_client_code}: {str(e)}\")\n            allure.attach(str(e), name=\"Exception Details\", attachment_type=allure.attachment_type.TEXT)\n            raise\n    \n        finally:\n            # Update Excel with results\n>           update_excel_results(\n                scenario=scenario,\n                payment_mode=payment_mode,\n                slab=slab,\n                request_amount=amount,\n                actual_bill=bill_amount,\n                conv_charges=conv_charges,\n                total_amount=total_amount,\n                status=status,\n                txn_id=txn_id\n            )\n\ntestCases\\Calculation_test.py:259: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nutilites\\calculation_excel_helper.py:15: in update_excel_results\n    df = pd.read_excel(file_path)\n.venv\\Lib\\site-packages\\pandas\\io\\excel\\_base.py:495: in read_excel\n    io = ExcelFile(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pandas.io.excel._base.ExcelFile object at 0x000001CB50C50E10>\npath_or_buffer = 'TestData/Calculation_Testing_Report.xlsx', engine = None\nstorage_options = None, engine_kwargs = {}\n\n    def __init__(\n        self,\n        path_or_buffer,\n        engine: str | None = None,\n        storage_options: StorageOptions | None = None,\n        engine_kwargs: dict | None = None,\n    ) -> None:\n        if engine_kwargs is None:\n            engine_kwargs = {}\n    \n        if engine is not None and engine not in self._engines:\n            raise ValueError(f\"Unknown engine: {engine}\")\n    \n        # First argument can also be bytes, so create a buffer\n        if isinstance(path_or_buffer, bytes):\n            path_or_buffer = BytesIO(path_or_buffer)\n            warnings.warn(\n                \"Passing bytes to 'read_excel' is deprecated and \"\n                \"will be removed in a future version. To read from a \"\n                \"byte string, wrap it in a `BytesIO` object.\",\n                FutureWarning,\n                stacklevel=find_stack_level(),\n            )\n    \n        # Could be a str, ExcelFile, Book, etc.\n        self.io = path_or_buffer\n        # Always a string\n        self._io = stringify_path(path_or_buffer)\n    \n        # Determine xlrd version if installed\n        if import_optional_dependency(\"xlrd\", errors=\"ignore\") is None:\n            xlrd_version = None\n        else:\n            import xlrd\n    \n            xlrd_version = Version(get_version(xlrd))\n    \n        if engine is None:\n            # Only determine ext if it is needed\n            ext: str | None\n            if xlrd_version is not None and isinstance(path_or_buffer, xlrd.Book):\n                ext = \"xls\"\n            else:\n                ext = inspect_excel_format(\n                    content_or_path=path_or_buffer, storage_options=storage_options\n                )\n                if ext is None:\n>                   raise ValueError(\n                        \"Excel file format cannot be determined, you must specify \"\n                        \"an engine manually.\"\n                    )\nE                   ValueError: Excel file format cannot be determined, you must specify an engine manually.\n\n.venv\\Lib\\site-packages\\pandas\\io\\excel\\_base.py:1554: ValueError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"attach_test_timestamp","time":{"start":1758800404587,"stop":1758800404610,"duration":23},"status":"passed","steps":[],"attachments":[{"uid":"74356bd5ac5bd32c","name":"Test Execution Timestamp","source":"74356bd5ac5bd32c.txt","type":"text/plain","size":19}],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":1,"stepsCount":0,"hasContent":true,"attachmentStep":false},{"name":"browser","time":{"start":1758800404611,"stop":1758800422728,"duration":18117},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1758800422729,"stop":1758800435049,"duration":12320},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page_with_screenshot","time":{"start":1758800435049,"stop":1758800435049,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ensure_db_updated","time":{"start":1758800435050,"stop":1758800447631,"duration":12581},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"ValueError: Excel file format cannot be determined, you must specify an engine manually.","statusTrace":"self = <testCases.Calculation_test.TestCalculations object at 0x000001CB507191D0>\npage_with_screenshot = <Page url='https://stage-securepay.sabpaisa.in/SabPaisa/sabPaisaInit?v=1'>\nscenario = 'S17', payment_mode = 'RuPay Card', slab = '1-1000', amount = 100\nexcel_client_code = 'DJ050', excel_environment = 'STAGING'\nensure_db_updated = None\n\n    @allure.story(\"Cancel Transaction Button Check\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.ui\n    @pytest.mark.regression\n    def test_calculation_amount(self, page_with_screenshot, scenario, payment_mode, slab, amount, excel_client_code,\n                                excel_environment, ensure_db_updated):\n        logger = LogGen.loggen(\"Calculation\")\n        \"\"\"Test the cancel transaction button functionality.\"\"\"\n        timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n        allure.dynamic.title(\n            f\"Calculation Testing | Scenario={scenario} | Mode={payment_mode} | Slab={slab} | Amount={amount}\"\n        )\n        logger.info(f\"--- Starting calculation Test for {scenario} | {payment_mode} | {slab} | {amount} ---\")\n    \n        bill_amount = conv_charges = total_amount = txn_id = \"N/A\"\n        status = \"Fail\"\n    \n        try:\n            if payment_mode == \"UPI INTENT\":\n                viewport_size = {\"width\": 375, \"height\": 667}  # Example: iPhone-like dimensions\n                page_with_screenshot.set_viewport_size(viewport_size)\n                logger.info(\n                    f\"Set viewport size to {viewport_size['width']}x{viewport_size['height']} for UPI INTENT mode\")\n                allure.attach(page_with_screenshot.screenshot(), name=\"UPI Intent Initial Viewport\",\n                              attachment_type=allure.attachment_type.PNG)\n    \n    \n            # Initialize page objects\n            client = ClientPage(page_with_screenshot)\n            client_details = ClientDetailsPage(page_with_screenshot)\n            pg = PaymentGatewayPage(page_with_screenshot)\n            pg_response = PaymentGatewayResponsePage(page_with_screenshot)\n    \n            # Fill and verify client and payer details\n            fill_and_verify_client_details(self.logger, client, client_details, excel_client_code, excel_environment)\n            fill_payer_details(\n                logger, client_details, ReadConfig.get_payer_first_name(),\n                ReadConfig.get_payer_last_name(), str(amount), ReadConfig.get_payer_phone(),\n                ReadConfig.get_payer_email()\n            )\n    \n            # Get transaction ID\n            with allure.step(f\"Accessing the Client_txn_id\"):\n                txn_id = client_details.get_value(\"_client_transaction_id\")\n                allure.attach(txn_id, name=f\"Client Transaction ID for {excel_client_code}\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            # Click Pay button\n            with allure.step(\"Clicking Pay Button\"):\n                logger.info(\"Clicking Pay button\")\n                client_details.click(\"_pay_btn\")\n    \n            time.sleep(5)\n    \n            # Handle payment mode and get amounts\n>           bill_amount, conv_charges, total_amount = self._handle_payment_mode(pg, payment_mode, logger)\n\ntestCases\\Calculation_test.py:216: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntestCases\\Calculation_test.py:59: in _handle_payment_mode\n    pg.select_payment_mode(\"_payment_mode\", pm_data[\"type\"])\npageObjects\\base_page.py:52: in select_payment_mode\n    modes.first.wait_for(state=\"visible\")\n.venv\\Lib\\site-packages\\playwright\\sync_api\\_generated.py:17736: in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n.venv\\Lib\\site-packages\\playwright\\_impl\\_locator.py:670: in wait_for\n    await self._frame.wait_for_selector(\n.venv\\Lib\\site-packages\\playwright\\_impl\\_frame.py:323: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n.venv\\Lib\\site-packages\\playwright\\_impl\\_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <playwright._impl._connection.Connection object at 0x000001CB505A7B60>\ncb = <function Channel.send.<locals>.<lambda> at 0x000001CB50B054E0>\nis_internal = False\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(task, \"__pw_stack__\", inspect.stack())\n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.wait_for: Timeout 30000ms exceeded.\nE           Call log:\nE           waiting for locator(\"p.title\").first to be visible\n\n.venv\\Lib\\site-packages\\playwright\\_impl\\_connection.py:520: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <testCases.Calculation_test.TestCalculations object at 0x000001CB507191D0>\npage_with_screenshot = <Page url='https://stage-securepay.sabpaisa.in/SabPaisa/sabPaisaInit?v=1'>\nscenario = 'S17', payment_mode = 'RuPay Card', slab = '1-1000', amount = 100\nexcel_client_code = 'DJ050', excel_environment = 'STAGING'\nensure_db_updated = None\n\n    @allure.story(\"Cancel Transaction Button Check\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.ui\n    @pytest.mark.regression\n    def test_calculation_amount(self, page_with_screenshot, scenario, payment_mode, slab, amount, excel_client_code,\n                                excel_environment, ensure_db_updated):\n        logger = LogGen.loggen(\"Calculation\")\n        \"\"\"Test the cancel transaction button functionality.\"\"\"\n        timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n        allure.dynamic.title(\n            f\"Calculation Testing | Scenario={scenario} | Mode={payment_mode} | Slab={slab} | Amount={amount}\"\n        )\n        logger.info(f\"--- Starting calculation Test for {scenario} | {payment_mode} | {slab} | {amount} ---\")\n    \n        bill_amount = conv_charges = total_amount = txn_id = \"N/A\"\n        status = \"Fail\"\n    \n        try:\n            if payment_mode == \"UPI INTENT\":\n                viewport_size = {\"width\": 375, \"height\": 667}  # Example: iPhone-like dimensions\n                page_with_screenshot.set_viewport_size(viewport_size)\n                logger.info(\n                    f\"Set viewport size to {viewport_size['width']}x{viewport_size['height']} for UPI INTENT mode\")\n                allure.attach(page_with_screenshot.screenshot(), name=\"UPI Intent Initial Viewport\",\n                              attachment_type=allure.attachment_type.PNG)\n    \n    \n            # Initialize page objects\n            client = ClientPage(page_with_screenshot)\n            client_details = ClientDetailsPage(page_with_screenshot)\n            pg = PaymentGatewayPage(page_with_screenshot)\n            pg_response = PaymentGatewayResponsePage(page_with_screenshot)\n    \n            # Fill and verify client and payer details\n            fill_and_verify_client_details(self.logger, client, client_details, excel_client_code, excel_environment)\n            fill_payer_details(\n                logger, client_details, ReadConfig.get_payer_first_name(),\n                ReadConfig.get_payer_last_name(), str(amount), ReadConfig.get_payer_phone(),\n                ReadConfig.get_payer_email()\n            )\n    \n            # Get transaction ID\n            with allure.step(f\"Accessing the Client_txn_id\"):\n                txn_id = client_details.get_value(\"_client_transaction_id\")\n                allure.attach(txn_id, name=f\"Client Transaction ID for {excel_client_code}\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            # Click Pay button\n            with allure.step(\"Clicking Pay Button\"):\n                logger.info(\"Clicking Pay button\")\n                client_details.click(\"_pay_btn\")\n    \n            time.sleep(5)\n    \n            # Handle payment mode and get amounts\n            bill_amount, conv_charges, total_amount = self._handle_payment_mode(pg, payment_mode, logger)\n    \n    \n            #time.sleep(10)\n    \n            # Handle failure for specific scenario and slab\n            # if scenario in [\"S8\", \"S13\", \"S16\", \"S24\", \"S21\"] and slab == \"5001-10000\":\n            #     status = \"Fail\"\n            #     with allure.step(\"transaction is aborted for scenario and slab\"):\n            #         allure.attach(\n            #             f\"Scenario={scenario}, Slab={slab} is restricted → marking as Fail\",\n            #             name=\"Failure\",\n            #             attachment_type=allure.attachment_type.TEXT\n            #         )\n            #     pytest.fail(f\"Scenario={scenario}, Slab={slab} →  test as failed \")\n    \n            # \uD83D\uDD39 Call the Payment Aborted check here\n            status = self._check_payment_aborted(page_with_screenshot)\n    \n    \n    \n            # # Wait for page to load and validate URL\n            # time.sleep(5)\n            # pg_response.page.wait_for_load_state(\"networkidle\")\n            # current_url = pg_response.get_current_url()\n            # self.logger.info(f\"URL after proceed to pay: {current_url}\")\n            #\n            # with allure.step(\"Validating the Base URL\"):\n            #     assert validate_base_url(current_url,\n            #                              excel_environment), f\"Base URL validation failed for {current_url}\"\n    \n    \n    \n    \n    \n        except Exception as e:\n            self.logger.exception(\n                f\"Exception occurred during Cancel Transaction Test for {excel_client_code}: {str(e)}\")\n            allure.attach(str(e), name=\"Exception Details\", attachment_type=allure.attachment_type.TEXT)\n            raise\n    \n        finally:\n            # Update Excel with results\n>           update_excel_results(\n                scenario=scenario,\n                payment_mode=payment_mode,\n                slab=slab,\n                request_amount=amount,\n                actual_bill=bill_amount,\n                conv_charges=conv_charges,\n                total_amount=total_amount,\n                status=status,\n                txn_id=txn_id\n            )\n\ntestCases\\Calculation_test.py:259: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nutilites\\calculation_excel_helper.py:15: in update_excel_results\n    df = pd.read_excel(file_path)\n.venv\\Lib\\site-packages\\pandas\\io\\excel\\_base.py:495: in read_excel\n    io = ExcelFile(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pandas.io.excel._base.ExcelFile object at 0x000001CB50C50E10>\npath_or_buffer = 'TestData/Calculation_Testing_Report.xlsx', engine = None\nstorage_options = None, engine_kwargs = {}\n\n    def __init__(\n        self,\n        path_or_buffer,\n        engine: str | None = None,\n        storage_options: StorageOptions | None = None,\n        engine_kwargs: dict | None = None,\n    ) -> None:\n        if engine_kwargs is None:\n            engine_kwargs = {}\n    \n        if engine is not None and engine not in self._engines:\n            raise ValueError(f\"Unknown engine: {engine}\")\n    \n        # First argument can also be bytes, so create a buffer\n        if isinstance(path_or_buffer, bytes):\n            path_or_buffer = BytesIO(path_or_buffer)\n            warnings.warn(\n                \"Passing bytes to 'read_excel' is deprecated and \"\n                \"will be removed in a future version. To read from a \"\n                \"byte string, wrap it in a `BytesIO` object.\",\n                FutureWarning,\n                stacklevel=find_stack_level(),\n            )\n    \n        # Could be a str, ExcelFile, Book, etc.\n        self.io = path_or_buffer\n        # Always a string\n        self._io = stringify_path(path_or_buffer)\n    \n        # Determine xlrd version if installed\n        if import_optional_dependency(\"xlrd\", errors=\"ignore\") is None:\n            xlrd_version = None\n        else:\n            import xlrd\n    \n            xlrd_version = Version(get_version(xlrd))\n    \n        if engine is None:\n            # Only determine ext if it is needed\n            ext: str | None\n            if xlrd_version is not None and isinstance(path_or_buffer, xlrd.Book):\n                ext = \"xls\"\n            else:\n                ext = inspect_excel_format(\n                    content_or_path=path_or_buffer, storage_options=storage_options\n                )\n                if ext is None:\n>                   raise ValueError(\n                        \"Excel file format cannot be determined, you must specify \"\n                        \"an engine manually.\"\n                    )\nE                   ValueError: Excel file format cannot be determined, you must specify an engine manually.\n\n.venv\\Lib\\site-packages\\pandas\\io\\excel\\_base.py:1554: ValueError","steps":[{"name":"Filling and verifying client details","time":{"start":1758800448003,"stop":1758800452592,"duration":4589},"status":"passed","steps":[{"name":"Filling Client Code : DJ050","time":{"start":1758800448003,"stop":1758800449262,"duration":1259},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Selecting Environment : STAGING","time":{"start":1758800449262,"stop":1758800450066,"duration":804},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Clicking Show Detail","time":{"start":1758800450066,"stop":1758800451288,"duration":1222},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Verifying if Payer Name is visible","time":{"start":1758800451288,"stop":1758800452592,"duration":1304},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"logger","value":"<RootLogger root (DEBUG)>"},{"name":"client","value":"<pageObjects.client_page.ClientPage object at 0x000001CB505A4830>"},{"name":"client_details","value":"<pageObjects.client_details_page.ClientDetailsPage object at 0x000001CB50BE9FD0>"},{"name":"client_code","value":"'DJ050'"},{"name":"environment","value":"'STAGING'"}],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":4,"hasContent":true,"attachmentStep":false},{"name":"Filling payer details","time":{"start":1758800452592,"stop":1758800453846,"duration":1254},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"logger","value":"<RootLogger root (DEBUG)>"},{"name":"client_details","value":"<pageObjects.client_details_page.ClientDetailsPage object at 0x000001CB50BE9FD0>"},{"name":"firstname","value":"'Bhargava'"},{"name":"lastname","value":"'Battina'"},{"name":"amount","value":"'100'"},{"name":"mobilenumber","value":"'1234567890'"},{"name":"email","value":"'test@sabpaisa.in'"}],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Accessing the Client_txn_id","time":{"start":1758800453846,"stop":1758800454233,"duration":387},"status":"passed","steps":[],"attachments":[{"uid":"16cd526223e58251","name":"Client Transaction ID for DJ050","source":"16cd526223e58251.txt","type":"text/plain","size":22}],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":1,"stepsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Clicking Pay Button","time":{"start":1758800454234,"stop":1758800457303,"duration":3069},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[{"uid":"1170c1e6074441a2","name":"Exception Details","source":"1170c1e6074441a2.txt","type":"text/plain","size":105}],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":2,"stepsCount":8,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"ensure_db_updated::0","time":{"start":1758800501921,"stop":1758800501921,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page_with_screenshot::0","time":{"start":1758800506470,"stop":1758800529016,"duration":22546},"status":"passed","steps":[],"attachments":[{"uid":"88c4c25fc29eba9d","name":"Screenshot","source":"88c4c25fc29eba9d.png","type":"image/png","size":78882},{"uid":"7371a1afc8821e73","name":"Test Video","source":"7371a1afc8821e73.webm","type":"video/webm","size":262144}],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"stepsCount":0,"hasContent":true,"attachmentStep":false},{"name":"page::0","time":{"start":1758800529022,"stop":1758800529022,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1758800529048,"stop":1758800529562,"duration":514},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"story","value":"Cancel Transaction Button Check"},{"name":"severity","value":"critical"},{"name":"epic","value":"Payment Gateway"},{"name":"tag","value":"regression"},{"name":"tag","value":"ui"},{"name":"parentSuite","value":"testCases"},{"name":"suite","value":"Calculation_test"},{"name":"subSuite","value":"TestCalculations"},{"name":"host","value":"SRS-CL-009"},{"name":"thread","value":"77452-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testCases.Calculation_test"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"amount","value":"100"},{"name":"excel_client_code","value":"'DJ050'"},{"name":"excel_environment","value":"'STAGING'"},{"name":"payment_mode","value":"'RuPay Card'"},{"name":"scenario","value":"'S17'"},{"name":"slab","value":"'1-1000'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["ui","regression"]},"source":"8a60e04377644631.json","parameterValues":["100","'DJ050'","'STAGING'","'RuPay Card'","'S17'","'1-1000'"]}